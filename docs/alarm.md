## Будильник

- [Подключение опции](#подключение-опции)
- [Описание будильника](#описание-будильника)
- [Опции будильника](#опции-будильника)
- [Настройка будильника](#настройка-будильника)
- [Взаимодействие с внешним кодом](#взаимодействие-с-внешним-кодом)
- [Смотри так же:](#смотри-так-же)


### Подключение опции

Для использования будильника нужно раскомментировать строку `#define USE_ALARM` в блоке **дополнительные опции - будильник** в файле **clockSetting.h**.

### Описание будильника

Состояние будильника показывает светодиод - если будильник включен, светодиод светится, если будильник сработал, светодиод мигает. Звуковой сигнал выводится на пассивный пьезокерамический излучатель. По умолчанию  будильник (если не отключать сигнал) может срабатывать до трех раз по одной минуте с интервалом между срабатываниями в две минуты.

Сигнал сработавшего будильника отключается кликом любой кнопки. 

### Опции будильника

Все настройки будильника задаются в блоке **дополнительные опции - будильник** в файле **clockSetting.h**.

- `uint8_t constexpr ALARM_DURATION = 60` - продолжительность сигнала будильника, секунд
- `uint8_t constexpr ALARM_SNOOZE_DELAY = 120` - задержка повтора сигнала будильника, секунд
- `uint8_t constexpr ALARM_REPETITION_COUNT = 3` - количество повторов сигнала будильника

Подключение звукового излучателя и индикаторного светодиода:

- `#define BUZZER_PIN 5` - пин для подключения пищалки;
- `#define ALARM_LED_PIN 7` - пин для подключения светодиода - индикатора будильника; если индикаторный светодиод использоваться не будет, можно задать для его пина значение -1;

### Настройка будильника

В режим настройки будильника по умолчанию можно перейти по двойному клику кнопкой **Set**. Или можно настроить переход в этот режим по одиночному клику кнопкой **Set**, для этого нужно раскомментировать строку `#define USE_ONECLICK_TO_SET_ALARM` в блоке **дополнительные опции - будильник** в файле **clockSetting.h**.

 Включение/выключение будильника выполняется кнопками **Up** или **Down**. После включения будильника следующий клик кнопкой **Set** переводит в режим настройки времени его срабатывания.

 Настройки будут сохранены в EEPROM.

 ### Взаимодействие с внешним кодом

 Библиотека позволяет получить, как время срабатывания, текущий статус будильника, так и устанавливать их. Для этого используются методы:
- `uint16_t getAlarmPoint()` - получение заданного времени срабатывания будильника; возвращает количество минут от начала суток;
- `void setAlarmPoint(uint16_t _point)` - задание времени срабатывания будильника; время задается количеством минут от начала суток (`hour * 60 + minute`);
- `void setAlarmPoint(uint8_t _hour, uint8_t _minute)` - то же самое, но в более привычном виде;
- `bool getOnOffAlarm()` - получение состояния: включен или выключен;
- `void setOnOffAlarm(bool _state)` - установка состояния будильника: включить или выключить;
- `AlarmState getAlarmState()` - получение статуса будильника, позволяет отслеживать срабатывание будильника; возвращает **ALARM_OFF(0)** - будильник выключен, **ALARM_ON(1)** - будильник включен, **ALARM_YES(2)** - будильник сработал;
- `void buzzerStop()` - отключение сигнала сработавшего будильника.

<hr>

### Смотри так же:
- [Главная страница](../readme.md)
- [Используемые модули RTC](rtc.md)
- [Используемые в часах экраны](displays.md)
- [Управление часами - кнопки](buttons.md)
- Дополнительные опции:
  - [Календарь](calendar.md)
  - [Регулировка уровней яркости экрана](br_adjust.md)
  - [Отображение температуры](show_temp.md)
  - [Опции для матричных экранов](matrix.md)
- Внешние датчики:
  - [Датчик освещенности](light_sensor.md)
  - [Датчики температуры](temp_sensors.md)
- [Описание файла `clockSetting.h`](clock_setting.md)
- [Взаимодействие с внешним кодом (API библиотеки)](api.md)
- [Руководство по настройкам часов](setting.md)

